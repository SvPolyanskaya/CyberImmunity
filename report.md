# Робот-фармацевт
Учебный пример для курса по кибериммунной разработке


- [Учебный пример "Робот-фармацевт.](#Учебный-пример-"Робот-Фрамацевт") 
- [Краткое описание назначения и применения системы.](#Краткое-описание-назначения-и-применения-системы)
-  [Ключевые ценности, ущербы, неприемлемые события)](#Ключевые-ценности,ущербы,неприемлимые_события)
- [Контекст работы системы](#Контекст-работы-системы)
       - [Вариант 1 ](#Вариант-1)
       - [Вариант 2 ](#Вариант-1)
- [Основные функциональные сценарии.](#Основные-функциональные-сценарии) 
- [Высокоуровневая архитектура системы.](#Высокоуровневая-архитектура-системы) 
- [Компоненты:  описание подсистем](#Компоненты:-описание-подсистем)
- [Описание Сценариев (последовательности выполнения операций), при которых ЦБ нарушаются](#описание-сценариев-последовательности-выполнения-операций-при-которых-цб-нарушаются)
- [Указание "доверенных компонент" на архитектурной диаграмме.](#указание-доверенных-компонент-на-архитектурной-диаграмме)
- [Политики безопасности](#Политики-безопасности)
- [Анализ векторов атак и эффекта.](#Анализ-векторов-атак-и-эффекта-безопасности.)
- [Упражнение.](#Упражнение)

•	Учебный пример "Светофор"
•	Краткое описание проектируемой системы
•	Ключевые ценности, ущербы, неприемлемые события
•	Контекст
•	Основные функциональные сценарии
•	Высокоуровневая архитектура
•	Описание подсистем
•	Расширенные диаграммы функциональных сценариев
•	Цели и предположения безопасности
•	Цели безопасности
•	Предположения безопасности
•	Таблица соотнесения ценностей, неприемлемых событий и целей безопасности
•	Негативные сценарии
•	Политика архитектуры
•	Версия 1
•	Версия 2
•	Прототип системы


Учебный пример "Робот-фармацевт"
![image](https://github.com/SvPolyanskaya/CyberImmunity/assets/163770686/dba32d39-8329-461a-8010-7a76d741f667)


- [Учебный пример "Робот-фармацевт.](#Учебный пример "Робот - Фрамацевт") 
- [Краткое описание проектируемой системы](#Краткое описание проектируемой системы)
- [Ключевые ценности, ущербы, неприемлемые события)](#Ключевые ценности, ущербы, неприемлемые события)
- [Высокоуровневая архитектура системы](#Высокоуровневая архитектура-системы)
- [Компоненты](#компоненты)
- [АлгориКраткое описание проектируемой системы
- [Описание Сценариев (последовательности выполнения операций), при которых ЦБ нарушаются](#описание-сценариев-последовательности-выполнения-операций-при-которых-цб-нарушаются)
- [Указание "доверенных компонент" на архитектурной диаграмме.](#указание-доверенных-компонент-на-архитектурной-диаграмме)
- [Политики безопасности](#политики-безопасности)
- [Анализ векторов атак и эффекта.](Анализ векторов атак и эффекта (упражнение)
## Учебный пример "Робот-фармацевт

Робот-фармацевт

![image](https://github.com/SvPolyanskaya/CyberImmunity/assets/163770686/be1ae8e9-5c97-4155-b25b-92425a7fb39b)

Продукт - робот-фармацевт, который производит лекарство по индивидуальному рецепту.
Рецепт включает в себя

а) точный состав и количество компонентов, порядок и условия изготовления конечного продукта

б) уникальный идентификатор лекарства, который изготавливается в определённом объёме для индивидуального курса лечения

Основные этапы процесса изготовления лекарства по рецепту

![](https://github.com/SvPolyanskaya/CyberImmunity/blob/Robot-in-Pharmacy/Осн%20этапы.png)
 

## Краткое описание назначения и применения системы

а) Робот-фармацевт управляется центральной системой по беспроводному интерфейсу

б) Робот-фармацевт передаёт состояние в центральную систему

Ценности продукта и негативные события в их отношении
|Ценность|	Негативное событие|	Величина ущерба|	Комментарий|
|----|----|----|----|
|Лекарство|Нарушение технологического процесса	|Высокий|возможно причинение вреда здоровью клиентов|
|Рецептура	| Неавторизованный доступ к рецептуре (раскрытие торгового секрета)	|Высокий|конкуренты смогут производить аналоги|
|Персональные данные|Неавторизованный доступ к персональным данным клиентов|Высокий|оборотный штраф для организации|
|Робот|невозможность производства лекарства из-за отказа оборудования|Средний	|при необходимости сотрудник фармацевт сможет вручную приготовить небольшие партии лекарств|
|Люди	|отравление из-за приёма неправильного лекарства|Высокий|возможно причинение вреда здоровью клиентов||

Роли пользователей
 - Оператор-фармацевт - вводит задание на производство и получает лекарство для передачи клиенту 

 - Пациент - получает рецепт от врача в клинике и по этому рецепту получает лекарство в аптеке

## Контекст работы системы
 ### Вариант 1. Лекарства общего назначения

 - Не предполагает льготного получения, не является наркотиком, не предполагает существенных ограничений для клиентов.
Однако лекарство может быть очень дорогим или с очень коротким сроком годности, поэтому клиенту важно получить свежее лекарство в минимально достаточной дозировке

![](https://github.com/SvPolyanskaya/CyberImmunity/blob/Robot-in-Pharmacy/-Контекст%201.png)

Упрощение

Чтобы не отвлекаться на систему управления складскими запасами предположим, что это реализовано на уровне аптечной сети - только тем роботам будет передано задание на производство, которые располагают достаточным запасом субстанций

 ### Вариант 2. Лекарства из специального списка
Варианты
-	входит в список жизненно-необходимых, производство полностью или частично оплачивается государством

-	содержит наркотические вещества или прекурсоры для их получения, авторизованное получение такого лекарства должно строго контролироваться
-	всё остальное из варианта 1.

  ![](https://github.com/SvPolyanskaya/CyberImmunity/blob/Robot-in-Pharmacy/-Контекст%202.png)

 ## Цели и предположения безопасности
 
Цели безопасности

 - Выполняются только аутентичные задания на производство
 
Предположения безопасности

- "доктор плохого не посоветует" - врачи, выписывающие рецепты, благонадёжны.
 
## Компоненты:  описание подсистем
| Название | Назначение | Комментарий |
|----|----|----|
|*1. Связь*|	отвечает за взаимодействие с системой распределения задач на изготовление и с базой данных рецептов|	получает полный рецепт или его идентификатор|
|*2. Измерение параметров субстанций*|контролирует массу и/или объём компонентов| 	---|
|*3. Центральная система управления*|	осуществляет общее управление процессом приготовления лекарства	|---|
|*4. Самодиагностика*|	осуществляет сбор и анализ телеметрии всех подсистем для оценки работоспособности системы|---|	
|*5. Перемещение компонентов*|	отвечает за расчёт траекторий перемещения робота на каждом этапе тех. процесса|	---|
|*6. Перемешивание*|осуществляет комплекс действий для достижения требуемого уровня смешения компонентов|	используется в том числе для подготовки промежуточных ёмкостей|---|
|*7. Маркировка*|изготавливает и наклеивает на ёмкость описание лекарства	|---|
|*8. Стерилизация*|осуществляет комплекс действий по стерилизации ёмкости с лекарством|включает контроль качества стерилизации|
|*9. Нагрев/охлаждение*|	обеспечивает требуемые по тех. процессу температурные условия для химических реакций|---|
|*10. Приводы*|	управляют захватами робота для реализации рассчитанных траекторий и механических воздействий на субстанции (в т.ч. измельчение и перемешивание)	|---|

### Основные функциональные сценарии получения лекарства
 Сценарий генерации событий
![Сценарий генерации событий](https://github.com/SvPolyanskaya/CyberImmunity/blob/Robot-in-Pharmacy/Robot%20pharmacy%20базовый%20сценарий.png))
 
### Описание Сценариев (последовательности выполнения операций), при которых ЦБ нарушаются
![Описание Сценариев:](https://www.planttext.com/api/plantuml/png/hLRBJXj14BpFLqny3_BxTOZua5msZgKW6MDvRQJSi2q84GHop25Hn2NdmS7W-FaBCt-KwkxPnRiOHKQvm7hSrTrLNTFh_R0NT7lzmvREzCDc8mYROKQfta6lrTGPU-FExCGkhN4dTch_wDoUjZ_nlCAd1pl6_pitS4DwqdQEq1c5-YEZyVsj-upZt_GzqW14oJvnqgcxHgaEoXyq3Zf1kuU2N-qQMCwJqK6eEn-2xc7G-9WCepPkxDXTsmTtoN7XSIfJ0I6_g8mRebzZv-wIIr-_RMitGEq1rrbOGmSZbAMeCPEGrYXj8Pcqo7KDK20E2Go8BUsASqtZdej9K9L0L8mrdBDo1hf6DQh9y199pC7KtOJbGqDsWZvHOeN3DVukXHkUnfobbCoIHvPlABHWjC-WASMQXsauzv17EMP9eC4j4p78UqRJvhpvbF9Pxu2fd_u5H-MooR1oYiGvnnjfWn7b9A2sPt-Gd8oWXg3gASGozXvAJpQ0jIImWahVcT8CYZATU10L5VHxH-t-uRjc5_RmLjAlty0kTKrZuB5ZVcnEBPz0QcHdRaXIhJGrn9S0ldGZ5Hu3NdWXk4Yb0HQPwGXWc54CjVRTJuIBAb1qrKTlceU227sfMTrPP41L9KGkkmiab_LLw8gAdUnA4XLIXwfrTDJHTAl8wdDgV8K0p0XFIs9BDK-z44GRDM0h8LAgaoIFZk3otD5JwxahRSUHeEJWUoY5Dh0tbdYwqYpV2LANA7M-hhdDXL0McWY4TT0MRC_N1aBGtedMbSf7Ohq0AwhbKmBb8vwRXwMupFzdBssabOqNXfYK3OKBI8U-dS8k29vUhQurkLMwP6g-VLcYaaqiJPtLFEjTCCA6AYK4h6tp8ZTLJj4u5ukhybR9es-bJ3cLiFni5HOhSJNDPbIy_bCBm1gbckttIf9KwlBwc_7xnSlmnRyri8U16CaQYOTRYLdi21I2bHINohC4dx-PVgyXcAl4I7V1rto3B0x_wVJTiZrw-ybjsig2Dtfg1ST1hvJQnp3mA-Sl)


**Отдельная диаграмма для первого негативного сценария - Verifier не проверил файл обновления:**
![](https://www.planttext.com/api/plantuml/png/hLRBRXf14BpFLqp8EHOFxmCEaJyabmrUAKWs87Qnb9iDikF8ZfrZ3eaYNt9Uas0JCF0BCt-KwfvXmouGX9MBFGnTtTNLZ-4WYeDEt3q-aeLk5DQ3A8mAGiID-2YK1NMdBzHGJLMYJzL8_PQbFQc-upp3fqSrmFzV-aptw2JL1APZChLNYSJtz_eZhd_Izt0343dxm4v7-XQXsWZVg3VQGJD6mCzg3YpxASWWakrtGUSugB_FcX6DEpNGj-fHNxDTT2AbVDa93tCEAx3yGT5q3xGJDT7NpE3sJLFgCr0uut1FAg6BFgAJrO1pCGp9UoNhT9_39q0XVoYH8B-fch6lKKfzFmlo2KJ1MCe92vX0taKCFslkaD9iJEo6h288gI5u8iGCbtFydPhSS1gm5oVhfGmlNn3eYT7MWoGNSwvfmhvxND41Im8DxZcH17ulgEZijvmhGD4smiWsmHLRbOfPCpUNn2NR9uO68zmieBgdlf6SZ212KFKSOYNg0KeFbu3LBD13fA-SqXYASZff8JmHTEDMitlyDkoWFMn7oLUlqJKrIMNWigD-tAFIV49IVJNMFP9g9eaGpmBQK_T5T09qHJuJlK-nApLfTAOhWD6DfgFcblxG92E2Ujmu2U8GNLWXe6-1our4zkJeMhBIuqKpYiDm2PuUVU6Jfr9n5rSf6bKk5IqJccpJVcgs70msliroaualX3XgjTeyjfB6b6PdGaBCW47HSPgIUaJmt0fBCe8G-bG2pu8uDLBvRvSnNSvWjPtrZLI3HOreAXuWFiXX9Krnkf5SaLCKAUNf28UYb6kIytWoQXc5W45dWYIcYgSI6j9sMon5KLxe_0niog1izIvl5hDi8Zav2oSD__y5CfpougTxoem6jp7cdYupX1rXo5LsmUT7eLgJaeR7qEUSRLvcgHl7PiA8ylffg8ggbUcPlgfM2wAJaR-wRWJoIRWv1IxD-6qWwmftRKqNACF4pSLqjyoYQwXmCJBh9rc6f6zSRicfH8YmUMZ7qQkPftxCZwZLy9Dz6l7O0D4tgt9rrZpXfTdjw6FDVlB-kP-yBPfuAvNQl6ZiveSJ9fPwr5Uyk9QamkM6oZfRftMtAAjwvBT3LWzdYnwE4O7VpDmRbo9U2760Ji3FoJy0))


![](https://github.com/SvPolyanskaya/CyberImmunity/blob/Robot-in-Pharmacy/Нарушение%20связи.png)

Упрощение
Чтобы не отвлекаться на систему управления складскими запасами предположим, что это реализовано на уровне аптечной сети - только тем роботам будет передано задание на производство, которые располагают достаточным запасом субстанций
 
задание на производство для конкретного робота-фармацевта

Робот-фармацевт
 
запрос рецепта рецепт

База данных рецептов
![](https://github.com/SvPolyanskaya/CyberImmunity/blob/Robot-in-Pharmacy/Нарушение%20связи.png)

Вариант 2. Лекарства из специального списка
варианты
-	входит в список жизненно-необходимых, производство полностью или частично оплачивается государством

-	содержит наркотические вещества или прекурсоры для их получения, авторизованное получение такого лекарства должно строго контролироваться
-	всё остальное из варианта 1.


задание на производство для конкретного робота-фармацевта


Робот-фармацевт
 

запрос рецепта рецепт
 
База данных рецептов (переделать ссылку)
https://github.com/SvPolyanskaya/CyberImmunity/blob/Robot-in-Pharmacy/Нарушение%20связи.png
 
	
 ### Алгоритм работы решения
  
### Анализ векторов атак и эффекта 
| Название | Назначение | Результат атаки |
|----|----|----| 
|1. Связь|	отвечает за взаимодействие с системой распределения задач на изготовление и с базой данных рецептов|в результате компрометации произошла подмена задания на производство|
|2. Измерение параметров субстанциЙ|контролирует массу и/или объём компонентов	||
|3. Центральная система управления|осуществляет общее управление процессом приготовления лекарства||
|4. Самодиагностика|осуществляет сбор и анализ телеметрии всех подсистем для оценки работоспособности системы||
|5. Перемещение компонентов|отвечает за расчёт траекторий перемещения робота на каждом этапе тех. процесса||
|6. Перемешивание|осуществляет комплекс действий для достижения требуемого уровня смешения компонентов||
|7. Маркировка|изготавливает и наклеивает на ёмкость описание лекарства	||
|8. Стерилизация|осуществляет комплекс действий по стерилизации ёмкости с лекарством||
|9. Нагрев/охлаждение|обеспечивает требуемые по тех. процессу температурные условия для химических реакций||
|10. Приводы|	управляют захватами робота для реализации рассчитанных траекторий и механических воздействий на субстанции (в т.ч. измельчение и перемешивание)	||
 ### Упражнение
Используя пример выше, изобразите развитие атаки через другие скомпрометированные компоненты (по одному в сценарии)

Если в результате развития атаки можно нарушить какую-либо ЦБ, то компонент обязан стать частью доверенной кодовой базы, если нет, то его следует рассматривать как недоверенный код.

Цели безопасности
1.	Выполняются только аутентичные задания на производство

2.	Для производства используются только авторизованные вещества

3.	Продукт имеет аутентичную маркировку



Предположения безопасности
- "доктор плохого не посоветует" - врачи, выписывающие рецепты, благонадёжны
 
Политика архитектуры


Легенда
недоверенная сущность


доверенная сущность


доверенная сущность,
повышающая целостность данных

высокоцелостные данные


низкоцелостные данные


Качественные оценки доменов
Сложность - S (simple), M(medium), C (complex) - простой, средней сложности, сложный
Размер (объём) кода - S, M, L, XL - маленький, среднего размера, большой, очень большой
- простой и маленький
 
 Обоснование уровня доверия доменов безопасности
| Домен безопасности | Уровень доверия	 | Обоснование |Комментарий|
|----|----|----| ----|
|1. Связь|недоверенный|   |    |
|2. Измерение параметров субстанций|недоверенный|   |    |
|3. Центральная система управления|недоверенный|   |    |
|4. Самодиагностика|недоверенный|   |    |	
|5. Перемещение компонентов|недоверенный|   |    |	
|6. Перемешиваниея|недоверенный|   |    |	
|7. Маркировка	|недоверенный|   |    |
|8. Стерилизация	|недоверенный|   |    |
|9. Нагрев/охлаждение|недоверенный|   |    |	
|10. Приводы	|недоверенный|   |    |
 
Домашнее задание: переработка политики архитектуры

Критерии хорошей политики архитектуры:

-	минимизировать размер и сложность TCB под заданные ЦПБ 1-3
-	обоснование уровня доверия приведено в таблице 1.
-	минимальное количество интерфейсов у доверенных компонентов

Другими словами
-	каждый доверенный домен безопасности, особенно "жёлтый", нужно стремиться делать простым и маленьким, количество входящих стрелок следует стремиться сделать минимальным

Что можно сделать
-	декомпозировать существующие домены безопасности
-	добавить новые домены безопасности, обеспечивающие достижение ЦБ при уменьшении размера довереной кодовой базы
-	следует заполнить таблицу 2 на следующей вкладке с описанием новых доменов безопасности и заполнить таблицу 3 с обоснованием выбора уровня доверия

